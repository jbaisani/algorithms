# 题目

假设淘宝一天有5亿条成交数据，求出销量最高的100个商品并给出算法的时间复杂度。

# 思路

可以把5亿个数据分组存放，比如放在5000个文件中。这样就可以分别在每个文件的10^6个数据中，用哈希+堆统计每个区域内前100个频率最高的商品，最后求出所有记录中出现频率最高的前100个商品。

哈希主要是去重, 这样交易数据中, 每个商品总共的销售数量就能确定下来.

哈希的时间复杂度是O(n), 从头扫到尾就行了... 堆排的时间复杂度就是O(nlogk), 算出最高的100个就行了.

# 类似题

有10亿个杂乱无章的数，怎样最快地求出其中前1000大的数

# 方法1

建一个1000个数的最小堆，然后依次添加剩余元素，如果大于堆顶的数（堆中最小的），将这个数替换堆顶，并调整结构使之仍然是一个最小堆，这样，遍历完后，堆中的1000个数就是所需的最大的1000个。算法的时间复杂度为O（nlogk）=n * log1000 = 10n（n为10亿，k为1000）。

优化的方法：分治法。可以把所有10亿个数据分组存放，比如分别放在1000个文件中。这样处理就可以分别在每个文件的10^6个数据中找出最大的10000个数，合并到一起再找出最终的结果。

# 方法2

1. 用每一个BIT标识一个整数的存在与否，这样一个字节可以标识8个整数的存在与否，对于所有32位的整数，需要512Mb，所以开辟一个512Mb的字符数组A，初始全0
2. 依次读取每个数n，对于数n，n存放在A[N>>3]中的某个bit，因此，将A[n>>3]设置为A[n>>3]|(1<<(n%8))(这里是1左移几位),相当于将每个数的对应位设置为1
3. 在A中，从数组尾开始向前遍历，从大到小读取1000个值为1的数，就是最大的1000个数了。

这样读文件就只需要1遍，在不考虑内存开销的情况下，应该是速度最快的方法了。

